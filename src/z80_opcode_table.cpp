#include "z80_opcode_table.h"
#include <algorithm>
#include <sstream>
#include <iomanip>
#include <cstring>

// Master Z80 opcode table — 1268 entries
// Generated from z80_opcodes.txt + cc_* cycle count arrays in z80.cpp.
// Single source of truth for both assembler and disassembler.

const Z80Opcode g_z80_opcodes[] = {
// ── NONE prefix (252 entries) ──
{OpcodePrefix::NONE      , 0x00, "nop"                       , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x01, "ld bc,**"                  , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0x02, "ld (bc),a"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x03, "inc bc"                    , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x04, "inc b"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x05, "dec b"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x06, "ld b,*"                    , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0x07, "rlca"                      , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x08, "ex af,af'"                 , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x09, "add hl,bc"                 , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0x0a, "ld a,(bc)"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x0b, "dec bc"                    , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x0c, "inc c"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x0d, "dec c"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x0e, "ld c,*"                    , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0x0f, "rrca"                      , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x10, "djnz *"                    , 2, 1, 12,  4, true},
{OpcodePrefix::NONE      , 0x11, "ld de,**"                  , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0x12, "ld (de),a"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x13, "inc de"                    , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x14, "inc d"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x15, "dec d"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x16, "ld d,*"                    , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0x17, "rla"                       , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x18, "jr *"                      , 2, 1, 12,  0, true},
{OpcodePrefix::NONE      , 0x19, "add hl,de"                 , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0x1a, "ld a,(de)"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x1b, "dec de"                    , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x1c, "inc e"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x1d, "dec e"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x1e, "ld e,*"                    , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0x1f, "rra"                       , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x20, "jr nz,*"                   , 2, 1,  8,  4, true},
{OpcodePrefix::NONE      , 0x21, "ld hl,**"                  , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0x22, "ld (**),hl"                , 3, 2, 20,  0, false},
{OpcodePrefix::NONE      , 0x23, "inc hl"                    , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x24, "inc h"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x25, "dec h"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x26, "ld h,*"                    , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0x27, "daa"                       , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x28, "jr z,*"                    , 2, 1,  8,  4, true},
{OpcodePrefix::NONE      , 0x29, "add hl,hl"                 , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0x2a, "ld hl,(**)"                , 3, 2, 20,  0, false},
{OpcodePrefix::NONE      , 0x2b, "dec hl"                    , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x2c, "inc l"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x2d, "dec l"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x2e, "ld l,*"                    , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0x2f, "cpl"                       , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x30, "jr nc,*"                   , 2, 1,  8,  4, true},
{OpcodePrefix::NONE      , 0x31, "ld sp,**"                  , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0x32, "ld (**),a"                 , 3, 2, 16,  0, false},
{OpcodePrefix::NONE      , 0x33, "inc sp"                    , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x34, "inc (hl)"                  , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0x35, "dec (hl)"                  , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0x36, "ld (hl),*"                 , 2, 1, 12,  0, false},
{OpcodePrefix::NONE      , 0x37, "scf"                       , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x38, "jr c,*"                    , 2, 1,  8,  4, true},
{OpcodePrefix::NONE      , 0x39, "add hl,sp"                 , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0x3a, "ld a,(**)"                 , 3, 2, 16,  0, false},
{OpcodePrefix::NONE      , 0x3b, "dec sp"                    , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x3c, "inc a"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x3d, "dec a"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x3e, "ld a,*"                    , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0x3f, "ccf"                       , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x40, "ld b,b"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x41, "ld b,c"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x42, "ld b,d"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x43, "ld b,e"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x44, "ld b,h"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x45, "ld b,l"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x46, "ld b,(hl)"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x47, "ld b,a"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x48, "ld c,b"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x49, "ld c,c"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x4a, "ld c,d"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x4b, "ld c,e"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x4c, "ld c,h"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x4d, "ld c,l"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x4e, "ld c,(hl)"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x4f, "ld c,a"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x50, "ld d,b"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x51, "ld d,c"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x52, "ld d,d"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x53, "ld d,e"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x54, "ld d,h"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x55, "ld d,l"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x56, "ld d,(hl)"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x57, "ld d,a"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x58, "ld e,b"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x59, "ld e,c"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x5a, "ld e,d"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x5b, "ld e,e"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x5c, "ld e,h"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x5d, "ld e,l"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x5e, "ld e,(hl)"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x5f, "ld e,a"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x60, "ld h,b"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x61, "ld h,c"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x62, "ld h,d"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x63, "ld h,e"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x64, "ld h,h"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x65, "ld h,l"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x66, "ld h,(hl)"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x67, "ld h,a"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x68, "ld l,b"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x69, "ld l,c"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x6a, "ld l,d"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x6b, "ld l,e"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x6c, "ld l,h"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x6d, "ld l,l"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x6e, "ld l,(hl)"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x6f, "ld l,a"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x70, "ld (hl),b"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x71, "ld (hl),c"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x72, "ld (hl),d"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x73, "ld (hl),e"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x74, "ld (hl),h"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x75, "ld (hl),l"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x76, "halt"                      , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x77, "ld (hl),a"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x78, "ld a,b"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x79, "ld a,c"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x7a, "ld a,d"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x7b, "ld a,e"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x7c, "ld a,h"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x7d, "ld a,l"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x7e, "ld a,(hl)"                 , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x7f, "ld a,a"                    , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x80, "add a,b"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x81, "add a,c"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x82, "add a,d"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x83, "add a,e"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x84, "add a,h"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x85, "add a,l"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x86, "add a,(hl)"                , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x87, "add a,a"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x88, "adc a,b"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x89, "adc a,c"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x8a, "adc a,d"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x8b, "adc a,e"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x8c, "adc a,h"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x8d, "adc a,l"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x8e, "adc a,(hl)"                , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x8f, "adc a,a"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x90, "sub b"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x91, "sub c"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x92, "sub d"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x93, "sub e"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x94, "sub h"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x95, "sub l"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x96, "sub (hl)"                  , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x97, "sub a"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x98, "sbc a,b"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x99, "sbc a,c"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x9a, "sbc a,d"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x9b, "sbc a,e"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x9c, "sbc a,h"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x9d, "sbc a,l"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0x9e, "sbc a,(hl)"                , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0x9f, "sbc a,a"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xa0, "and b"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xa1, "and c"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xa2, "and d"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xa3, "and e"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xa4, "and h"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xa5, "and l"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xa6, "and (hl)"                  , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0xa7, "and a"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xa8, "xor b"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xa9, "xor c"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xaa, "xor d"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xab, "xor e"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xac, "xor h"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xad, "xor l"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xae, "xor (hl)"                  , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0xaf, "xor a"                     , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xb0, "or b"                      , 1, 0,  4,  4, false},
{OpcodePrefix::NONE      , 0xb1, "or c"                      , 1, 0,  4,  8, false},
{OpcodePrefix::NONE      , 0xb2, "or d"                      , 1, 0,  4,  4, false},
{OpcodePrefix::NONE      , 0xb3, "or e"                      , 1, 0,  4,  4, false},
{OpcodePrefix::NONE      , 0xb4, "or h"                      , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xb5, "or l"                      , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xb6, "or (hl)"                   , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0xb7, "or a"                      , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xb8, "cp b"                      , 1, 0,  4,  4, false},
{OpcodePrefix::NONE      , 0xb9, "cp c"                      , 1, 0,  4,  8, false},
{OpcodePrefix::NONE      , 0xba, "cp d"                      , 1, 0,  4,  4, false},
{OpcodePrefix::NONE      , 0xbb, "cp e"                      , 1, 0,  4,  4, false},
{OpcodePrefix::NONE      , 0xbc, "cp h"                      , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xbd, "cp l"                      , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xbe, "cp (hl)"                   , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0xbf, "cp a"                      , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xc0, "ret nz"                    , 1, 0,  8,  8, false},
{OpcodePrefix::NONE      , 0xc1, "pop bc"                    , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0xc2, "jp nz,**"                  , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0xc3, "jp **"                     , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0xc4, "call nz,**"                , 3, 2, 12,  8, false},
{OpcodePrefix::NONE      , 0xc5, "push bc"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xc6, "add a,*"                   , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0xc7, "rst 00h"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xc8, "ret z"                     , 1, 0,  8,  8, false},
{OpcodePrefix::NONE      , 0xc9, "ret"                       , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0xca, "jp z,**"                   , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0xcc, "call z,**"                 , 3, 2, 12,  8, false},
{OpcodePrefix::NONE      , 0xcd, "call **"                   , 3, 2, 20,  0, false},
{OpcodePrefix::NONE      , 0xce, "adc a,*"                   , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0xcf, "rst 08h"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xd0, "ret nc"                    , 1, 0,  8,  8, false},
{OpcodePrefix::NONE      , 0xd1, "pop de"                    , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0xd2, "jp nc,**"                  , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0xd3, "out (*),a"                 , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0xd4, "call nc,**"                , 3, 2, 12,  8, false},
{OpcodePrefix::NONE      , 0xd5, "push de"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xd6, "sub *"                     , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0xd7, "rst 10h"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xd8, "ret c"                     , 1, 0,  8,  8, false},
{OpcodePrefix::NONE      , 0xd9, "exx"                       , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xda, "jp c,**"                   , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0xdb, "in a,(*)"                  , 2, 1, 12,  0, false},
{OpcodePrefix::NONE      , 0xdc, "call c,**"                 , 3, 2, 12,  8, false},
{OpcodePrefix::NONE      , 0xde, "sbc a,*"                   , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0xdf, "rst 18h"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xe0, "ret po"                    , 1, 0,  8,  8, false},
{OpcodePrefix::NONE      , 0xe1, "pop hl"                    , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0xe2, "jp po,**"                  , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0xe3, "ex (sp),hl"                , 1, 0, 24,  0, false},
{OpcodePrefix::NONE      , 0xe4, "call po,**"                , 3, 2, 12,  8, false},
{OpcodePrefix::NONE      , 0xe5, "push hl"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xe6, "and *"                     , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0xe7, "rst 20h"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xe8, "ret pe"                    , 1, 0,  8,  8, false},
{OpcodePrefix::NONE      , 0xe9, "jp (hl)"                   , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xea, "jp pe,**"                  , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0xeb, "ex de,hl"                  , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xec, "call pe,**"                , 3, 2, 12,  8, false},
{OpcodePrefix::NONE      , 0xee, "xor *"                     , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0xef, "rst 28h"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xf0, "ret p"                     , 1, 0,  8,  8, false},
{OpcodePrefix::NONE      , 0xf1, "pop af"                    , 1, 0, 12,  0, false},
{OpcodePrefix::NONE      , 0xf2, "jp p,**"                   , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0xf3, "di"                        , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xf4, "call p,**"                 , 3, 2, 12,  8, false},
{OpcodePrefix::NONE      , 0xf5, "push af"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xf6, "or *"                      , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0xf7, "rst 30h"                   , 1, 0, 16,  0, false},
{OpcodePrefix::NONE      , 0xf8, "ret m"                     , 1, 0,  8,  8, false},
{OpcodePrefix::NONE      , 0xf9, "ld sp,hl"                  , 1, 0,  8,  0, false},
{OpcodePrefix::NONE      , 0xfa, "jp m,**"                   , 3, 2, 12,  0, false},
{OpcodePrefix::NONE      , 0xfb, "ei"                        , 1, 0,  4,  0, false},
{OpcodePrefix::NONE      , 0xfc, "call m,**"                 , 3, 2, 12,  8, false},
{OpcodePrefix::NONE      , 0xfe, "cp *"                      , 2, 1,  8,  0, false},
{OpcodePrefix::NONE      , 0xff, "rst 38h"                   , 1, 0, 16,  0, false},

// ── CB prefix (256 entries) ──
{OpcodePrefix::CB        , 0x00, "rlc b"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x01, "rlc c"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x02, "rlc d"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x03, "rlc e"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x04, "rlc h"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x05, "rlc l"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x06, "rlc (hl)"                  , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x07, "rlc a"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x08, "rrc b"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x09, "rrc c"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x0a, "rrc d"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x0b, "rrc e"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x0c, "rrc h"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x0d, "rrc l"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x0e, "rrc (hl)"                  , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x0f, "rrc a"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x10, "rl b"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x11, "rl c"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x12, "rl d"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x13, "rl e"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x14, "rl h"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x15, "rl l"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x16, "rl (hl)"                   , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x17, "rl a"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x18, "rr b"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x19, "rr c"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x1a, "rr d"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x1b, "rr e"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x1c, "rr h"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x1d, "rr l"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x1e, "rr (hl)"                   , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x1f, "rr a"                      , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x20, "sla b"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x21, "sla c"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x22, "sla d"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x23, "sla e"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x24, "sla h"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x25, "sla l"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x26, "sla (hl)"                  , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x27, "sla a"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x28, "sra b"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x29, "sra c"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x2a, "sra d"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x2b, "sra e"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x2c, "sra h"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x2d, "sra l"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x2e, "sra (hl)"                  , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x2f, "sra a"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x30, "sll b"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x31, "sll c"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x32, "sll d"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x33, "sll e"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x34, "sll h"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x35, "sll l"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x36, "sll (hl)"                  , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x37, "sll a"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x38, "srl b"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x39, "srl c"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x3a, "srl d"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x3b, "srl e"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x3c, "srl h"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x3d, "srl l"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x3e, "srl (hl)"                  , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x3f, "srl a"                     , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x40, "bit 0,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x41, "bit 0,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x42, "bit 0,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x43, "bit 0,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x44, "bit 0,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x45, "bit 0,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x46, "bit 0,(hl)"                , 2, 0, 12,  0, false},
{OpcodePrefix::CB        , 0x47, "bit 0,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x48, "bit 1,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x49, "bit 1,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x4a, "bit 1,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x4b, "bit 1,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x4c, "bit 1,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x4d, "bit 1,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x4e, "bit 1,(hl)"                , 2, 0, 12,  0, false},
{OpcodePrefix::CB        , 0x4f, "bit 1,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x50, "bit 2,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x51, "bit 2,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x52, "bit 2,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x53, "bit 2,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x54, "bit 2,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x55, "bit 2,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x56, "bit 2,(hl)"                , 2, 0, 12,  0, false},
{OpcodePrefix::CB        , 0x57, "bit 2,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x58, "bit 3,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x59, "bit 3,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x5a, "bit 3,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x5b, "bit 3,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x5c, "bit 3,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x5d, "bit 3,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x5e, "bit 3,(hl)"                , 2, 0, 12,  0, false},
{OpcodePrefix::CB        , 0x5f, "bit 3,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x60, "bit 4,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x61, "bit 4,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x62, "bit 4,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x63, "bit 4,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x64, "bit 4,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x65, "bit 4,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x66, "bit 4,(hl)"                , 2, 0, 12,  0, false},
{OpcodePrefix::CB        , 0x67, "bit 4,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x68, "bit 5,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x69, "bit 5,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x6a, "bit 5,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x6b, "bit 5,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x6c, "bit 5,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x6d, "bit 5,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x6e, "bit 5,(hl)"                , 2, 0, 12,  0, false},
{OpcodePrefix::CB        , 0x6f, "bit 5,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x70, "bit 6,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x71, "bit 6,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x72, "bit 6,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x73, "bit 6,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x74, "bit 6,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x75, "bit 6,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x76, "bit 6,(hl)"                , 2, 0, 12,  0, false},
{OpcodePrefix::CB        , 0x77, "bit 6,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x78, "bit 7,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x79, "bit 7,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x7a, "bit 7,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x7b, "bit 7,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x7c, "bit 7,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x7d, "bit 7,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x7e, "bit 7,(hl)"                , 2, 0, 12,  0, false},
{OpcodePrefix::CB        , 0x7f, "bit 7,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x80, "res 0,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x81, "res 0,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x82, "res 0,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x83, "res 0,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x84, "res 0,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x85, "res 0,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x86, "res 0,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x87, "res 0,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x88, "res 1,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x89, "res 1,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x8a, "res 1,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x8b, "res 1,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x8c, "res 1,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x8d, "res 1,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x8e, "res 1,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x8f, "res 1,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x90, "res 2,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x91, "res 2,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x92, "res 2,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x93, "res 2,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x94, "res 2,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x95, "res 2,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x96, "res 2,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x97, "res 2,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x98, "res 3,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x99, "res 3,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x9a, "res 3,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x9b, "res 3,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x9c, "res 3,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x9d, "res 3,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0x9e, "res 3,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0x9f, "res 3,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xa0, "res 4,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xa1, "res 4,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xa2, "res 4,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xa3, "res 4,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xa4, "res 4,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xa5, "res 4,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xa6, "res 4,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xa7, "res 4,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xa8, "res 5,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xa9, "res 5,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xaa, "res 5,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xab, "res 5,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xac, "res 5,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xad, "res 5,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xae, "res 5,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xaf, "res 5,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xb0, "res 6,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xb1, "res 6,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xb2, "res 6,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xb3, "res 6,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xb4, "res 6,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xb5, "res 6,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xb6, "res 6,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xb7, "res 6,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xb8, "res 7,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xb9, "res 7,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xba, "res 7,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xbb, "res 7,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xbc, "res 7,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xbd, "res 7,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xbe, "res 7,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xbf, "res 7,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xc0, "set 0,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xc1, "set 0,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xc2, "set 0,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xc3, "set 0,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xc4, "set 0,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xc5, "set 0,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xc6, "set 0,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xc7, "set 0,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xc8, "set 1,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xc9, "set 1,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xca, "set 1,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xcb, "set 1,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xcc, "set 1,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xcd, "set 1,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xce, "set 1,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xcf, "set 1,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xd0, "set 2,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xd1, "set 2,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xd2, "set 2,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xd3, "set 2,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xd4, "set 2,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xd5, "set 2,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xd6, "set 2,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xd7, "set 2,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xd8, "set 3,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xd9, "set 3,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xda, "set 3,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xdb, "set 3,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xdc, "set 3,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xdd, "set 3,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xde, "set 3,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xdf, "set 3,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xe0, "set 4,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xe1, "set 4,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xe2, "set 4,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xe3, "set 4,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xe4, "set 4,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xe5, "set 4,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xe6, "set 4,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xe7, "set 4,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xe8, "set 5,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xe9, "set 5,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xea, "set 5,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xeb, "set 5,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xec, "set 5,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xed, "set 5,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xee, "set 5,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xef, "set 5,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xf0, "set 6,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xf1, "set 6,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xf2, "set 6,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xf3, "set 6,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xf4, "set 6,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xf5, "set 6,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xf6, "set 6,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xf7, "set 6,a"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xf8, "set 7,b"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xf9, "set 7,c"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xfa, "set 7,d"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xfb, "set 7,e"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xfc, "set 7,h"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xfd, "set 7,l"                   , 2, 0,  8,  0, false},
{OpcodePrefix::CB        , 0xfe, "set 7,(hl)"                , 2, 0, 16,  0, false},
{OpcodePrefix::CB        , 0xff, "set 7,a"                   , 2, 0,  8,  0, false},

// ── ED prefix (78 entries) ──
{OpcodePrefix::ED        , 0x40, "in b,(c)"                  , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x41, "out (c),b"                 , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x42, "sbc hl,bc"                 , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x43, "ld (**),bc"                , 4, 2, 20,  0, false},
{OpcodePrefix::ED        , 0x44, "neg"                       , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x45, "retn"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x46, "im 0"                      , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x47, "ld i,a"                    , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x48, "in c,(c)"                  , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x49, "out (c),c"                 , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x4a, "adc hl,bc"                 , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x4b, "ld bc,(**)"                , 4, 2, 20,  0, false},
{OpcodePrefix::ED        , 0x4c, "neg"                       , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x4d, "reti"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x4e, "im 0/1"                    , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x4f, "ld r,a"                    , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x50, "in d,(c)"                  , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x51, "out (c),d"                 , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x52, "sbc hl,de"                 , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x53, "ld (**),de"                , 4, 2, 20,  0, false},
{OpcodePrefix::ED        , 0x54, "neg"                       , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x55, "retn"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x56, "im 1"                      , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x57, "ld a,i"                    , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x58, "in e,(c)"                  , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x59, "out (c),e"                 , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x5a, "adc hl,de"                 , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x5b, "ld de,(**)"                , 4, 2, 20,  0, false},
{OpcodePrefix::ED        , 0x5c, "neg"                       , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x5d, "retn"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x5e, "im 2"                      , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x5f, "ld a,r"                    , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x60, "in h,(c)"                  , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x61, "out (c),h"                 , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x62, "sbc hl,hl"                 , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x63, "ld (**),hl"                , 4, 2, 20,  0, false},
{OpcodePrefix::ED        , 0x64, "neg"                       , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x65, "retn"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x66, "im 0"                      , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x67, "rrd"                       , 2, 0, 16,  0, false},
{OpcodePrefix::ED        , 0x68, "in l,(c)"                  , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x69, "out (c),l"                 , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x6a, "adc hl,hl"                 , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x6b, "ld hl,(**)"                , 4, 2, 20,  0, false},
{OpcodePrefix::ED        , 0x6c, "neg"                       , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x6d, "retn"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x6e, "im 0/1"                    , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x6f, "rld"                       , 2, 0, 16,  0, false},
{OpcodePrefix::ED        , 0x70, "in (c)"                    , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x71, "out (c),0"                 , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x72, "sbc hl,sp"                 , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x73, "ld (**),sp"                , 4, 2, 20,  0, false},
{OpcodePrefix::ED        , 0x74, "neg"                       , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x75, "retn"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x76, "im 1"                      , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x78, "in a,(c)"                  , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x79, "out (c),a"                 , 2, 0,  8,  0, false},
{OpcodePrefix::ED        , 0x7a, "adc hl,sp"                 , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x7b, "ld sp,(**)"                , 4, 2, 20,  0, false},
{OpcodePrefix::ED        , 0x7c, "neg"                       , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0x7d, "retn"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0x7e, "im 2"                      , 2, 0,  4,  0, false},
{OpcodePrefix::ED        , 0xa0, "ldi"                       , 2, 0, 16,  0, false},
{OpcodePrefix::ED        , 0xa1, "cpi"                       , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0xa2, "ini"                       , 2, 0, 16,  0, false},
{OpcodePrefix::ED        , 0xa3, "outi"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0xa8, "ldd"                       , 2, 0, 16,  0, false},
{OpcodePrefix::ED        , 0xa9, "cpd"                       , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0xaa, "ind"                       , 2, 0, 16,  0, false},
{OpcodePrefix::ED        , 0xab, "outd"                      , 2, 0, 12,  0, false},
{OpcodePrefix::ED        , 0xb0, "ldir"                      , 2, 0, 16,  4, false},
{OpcodePrefix::ED        , 0xb1, "cpir"                      , 2, 0, 12,  4, false},
{OpcodePrefix::ED        , 0xb2, "inir"                      , 2, 0, 16,  4, false},
{OpcodePrefix::ED        , 0xb3, "otir"                      , 2, 0, 12,  4, false},
{OpcodePrefix::ED        , 0xb8, "lddr"                      , 2, 0, 16,  4, false},
{OpcodePrefix::ED        , 0xb9, "cpdr"                      , 2, 0, 12,  4, false},
{OpcodePrefix::ED        , 0xba, "indr"                      , 2, 0, 16,  4, false},
{OpcodePrefix::ED        , 0xbb, "otdr"                      , 2, 0, 12,  4, false},

// ── DD prefix (85 entries) ──
{OpcodePrefix::DD        , 0x09, "add ix,bc"                 , 2, 0, 12,  0, false},
{OpcodePrefix::DD        , 0x19, "add ix,de"                 , 2, 0, 12,  0, false},
{OpcodePrefix::DD        , 0x21, "ld ix,**"                  , 4, 2, 12,  0, false},
{OpcodePrefix::DD        , 0x22, "ld (**),ix"                , 4, 2, 20,  0, false},
{OpcodePrefix::DD        , 0x23, "inc ix"                    , 2, 0,  8,  0, false},
{OpcodePrefix::DD        , 0x24, "inc ixh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x25, "dec ixh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x26, "ld ixh,*"                  , 3, 1,  8,  0, false},
{OpcodePrefix::DD        , 0x29, "add ix,ix"                 , 2, 0, 12,  0, false},
{OpcodePrefix::DD        , 0x2a, "ld ix,(**)"                , 4, 2, 20,  0, false},
{OpcodePrefix::DD        , 0x2b, "dec ix"                    , 2, 0,  8,  0, false},
{OpcodePrefix::DD        , 0x2c, "inc ixl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x2d, "dec ixl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x2e, "ld ixl,*"                  , 3, 1,  8,  0, false},
{OpcodePrefix::DD        , 0x34, "inc (ix+*)"                , 3, 1, 20,  0, false},
{OpcodePrefix::DD        , 0x35, "dec (ix+*)"                , 3, 1, 20,  0, false},
{OpcodePrefix::DD        , 0x36, "ld (ix+*),*"               , 4, 2, 20,  0, false},
{OpcodePrefix::DD        , 0x39, "add ix,sp"                 , 2, 0, 12,  0, false},
{OpcodePrefix::DD        , 0x44, "ld b,ixh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x45, "ld b,ixl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x46, "ld b,(ix+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x4c, "ld c,ixh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x4d, "ld c,ixl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x4e, "ld c,(ix+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x54, "ld d,ixh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x55, "ld d,ixl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x56, "ld d,(ix+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x5c, "ld e,ixh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x5d, "ld e,ixl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x5e, "ld e,(ix+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x60, "ld ixh,b"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x61, "ld ixh,c"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x62, "ld ixh,d"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x63, "ld ixh,e"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x64, "ld ixh,ixh"                , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x65, "ld ixh,ixl"                , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x66, "ld h,(ix+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x67, "ld ixh,a"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x68, "ld ixl,b"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x69, "ld ixl,c"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x6a, "ld ixl,d"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x6b, "ld ixl,e"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x6c, "ld ixl,ixh"                , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x6d, "ld ixl,ixl"                , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x6e, "ld l,(ix+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x6f, "ld ixl,a"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x70, "ld (ix+*),b"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x71, "ld (ix+*),c"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x72, "ld (ix+*),d"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x73, "ld (ix+*),e"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x74, "ld (ix+*),h"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x75, "ld (ix+*),l"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x77, "ld (ix+*),a"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x7c, "ld a,ixh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x7d, "ld a,ixl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x7e, "ld a,(ix+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x84, "add a,ixh"                 , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x85, "add a,ixl"                 , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x86, "add a,(ix+*)"              , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x8c, "adc a,ixh"                 , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x8d, "adc a,ixl"                 , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x8e, "adc a,(ix+*)"              , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x94, "sub ixh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x95, "sub ixl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x96, "sub (ix+*)"                , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0x9c, "sbc a,ixh"                 , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x9d, "sbc a,ixl"                 , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0x9e, "sbc a,(ix+*)"              , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0xa4, "and ixh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0xa5, "and ixl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0xa6, "and (ix+*)"                , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0xac, "xor ixh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0xad, "xor ixl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0xae, "xor (ix+*)"                , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0xb4, "or ixh"                    , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0xb5, "or ixl"                    , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0xb6, "or (ix+*)"                 , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0xbc, "cp ixh"                    , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0xbd, "cp ixl"                    , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0xbe, "cp (ix+*)"                 , 3, 1, 16,  0, false},
{OpcodePrefix::DD        , 0xe1, "pop ix"                    , 2, 0, 12,  0, false},
{OpcodePrefix::DD        , 0xe3, "ex (sp),ix"                , 2, 0, 24,  0, false},
{OpcodePrefix::DD        , 0xe5, "push ix"                   , 2, 0, 16,  0, false},
{OpcodePrefix::DD        , 0xe9, "jp (ix)"                   , 2, 0,  4,  0, false},
{OpcodePrefix::DD        , 0xf9, "ld sp,ix"                  , 2, 0,  8,  0, false},

// ── FD prefix (85 entries) ──
{OpcodePrefix::FD        , 0x09, "add iy,bc"                 , 2, 0, 12,  0, false},
{OpcodePrefix::FD        , 0x19, "add iy,de"                 , 2, 0, 12,  0, false},
{OpcodePrefix::FD        , 0x21, "ld iy,**"                  , 4, 2, 12,  0, false},
{OpcodePrefix::FD        , 0x22, "ld (**),iy"                , 4, 2, 20,  0, false},
{OpcodePrefix::FD        , 0x23, "inc iy"                    , 2, 0,  8,  0, false},
{OpcodePrefix::FD        , 0x24, "inc iyh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x25, "dec iyh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x26, "ld iyh,*"                  , 3, 1,  8,  0, false},
{OpcodePrefix::FD        , 0x29, "add iy,iy"                 , 2, 0, 12,  0, false},
{OpcodePrefix::FD        , 0x2a, "ld iy,(**)"                , 4, 2, 20,  0, false},
{OpcodePrefix::FD        , 0x2b, "dec iy"                    , 2, 0,  8,  0, false},
{OpcodePrefix::FD        , 0x2c, "inc iyl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x2d, "dec iyl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x2e, "ld iyl,*"                  , 3, 1,  8,  0, false},
{OpcodePrefix::FD        , 0x34, "inc (iy+*)"                , 3, 1, 20,  0, false},
{OpcodePrefix::FD        , 0x35, "dec (iy+*)"                , 3, 1, 20,  0, false},
{OpcodePrefix::FD        , 0x36, "ld (iy+*),*"               , 4, 2, 20,  0, false},
{OpcodePrefix::FD        , 0x39, "add iy,sp"                 , 2, 0, 12,  0, false},
{OpcodePrefix::FD        , 0x44, "ld b,iyh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x45, "ld b,iyl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x46, "ld b,(iy+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x4c, "ld c,iyh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x4d, "ld c,iyl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x4e, "ld c,(iy+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x54, "ld d,iyh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x55, "ld d,iyl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x56, "ld d,(iy+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x5c, "ld e,iyh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x5d, "ld e,iyl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x5e, "ld e,(iy+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x60, "ld iyh,b"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x61, "ld iyh,c"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x62, "ld iyh,d"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x63, "ld iyh,e"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x64, "ld iyh,iyh"                , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x65, "ld iyh,iyl"                , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x66, "ld h,(iy+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x67, "ld iyh,a"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x68, "ld iyl,b"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x69, "ld iyl,c"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x6a, "ld iyl,d"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x6b, "ld iyl,e"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x6c, "ld iyl,iyh"                , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x6d, "ld iyl,iyl"                , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x6e, "ld l,(iy+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x6f, "ld iyl,a"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x70, "ld (iy+*),b"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x71, "ld (iy+*),c"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x72, "ld (iy+*),d"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x73, "ld (iy+*),e"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x74, "ld (iy+*),h"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x75, "ld (iy+*),l"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x77, "ld (iy+*),a"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x7c, "ld a,iyh"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x7d, "ld a,iyl"                  , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x7e, "ld a,(iy+*)"               , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x84, "add a,iyh"                 , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x85, "add a,iyl"                 , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x86, "add a,(iy+*)"              , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x8c, "adc a,iyh"                 , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x8d, "adc a,iyl"                 , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x8e, "adc a,(iy+*)"              , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x94, "sub iyh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x95, "sub iyl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x96, "sub (iy+*)"                , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0x9c, "sbc a,iyh"                 , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x9d, "sbc a,iyl"                 , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0x9e, "sbc a,(iy+*)"              , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0xa4, "and iyh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0xa5, "and iyl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0xa6, "and (iy+*)"                , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0xac, "xor iyh"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0xad, "xor iyl"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0xae, "xor (iy+*)"                , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0xb4, "or iyh"                    , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0xb5, "or iyl"                    , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0xb6, "or (iy+*)"                 , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0xbc, "cp iyh"                    , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0xbd, "cp iyl"                    , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0xbe, "cp (iy+*)"                 , 3, 1, 16,  0, false},
{OpcodePrefix::FD        , 0xe1, "pop iy"                    , 2, 0, 12,  0, false},
{OpcodePrefix::FD        , 0xe3, "ex (sp),iy"                , 2, 0, 24,  0, false},
{OpcodePrefix::FD        , 0xe5, "push iy"                   , 2, 0, 16,  0, false},
{OpcodePrefix::FD        , 0xe9, "jp (iy)"                   , 2, 0,  4,  0, false},
{OpcodePrefix::FD        , 0xf9, "ld sp,iy"                  , 2, 0,  8,  0, false},

// ── DDCB prefix (256 entries) ──
{OpcodePrefix::DDCB      , 0x00, "rlc (ix+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x01, "rlc (ix+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x02, "rlc (ix+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x03, "rlc (ix+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x04, "rlc (ix+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x05, "rlc (ix+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x06, "rlc (ix+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x07, "rlc (ix+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x08, "rrc (ix+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x09, "rrc (ix+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x0a, "rrc (ix+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x0b, "rrc (ix+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x0c, "rrc (ix+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x0d, "rrc (ix+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x0e, "rrc (ix+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x0f, "rrc (ix+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x10, "rl (ix+*),b"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x11, "rl (ix+*),c"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x12, "rl (ix+*),d"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x13, "rl (ix+*),e"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x14, "rl (ix+*),h"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x15, "rl (ix+*),l"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x16, "rl (ix+*)"                 , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x17, "rl (ix+*),a"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x18, "rr (ix+*),b"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x19, "rr (ix+*),c"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x1a, "rr (ix+*),d"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x1b, "rr (ix+*),e"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x1c, "rr (ix+*),h"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x1d, "rr (ix+*),l"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x1e, "rr (ix+*)"                 , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x1f, "rr (ix+*),a"               , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x20, "sla (ix+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x21, "sla (ix+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x22, "sla (ix+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x23, "sla (ix+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x24, "sla (ix+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x25, "sla (ix+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x26, "sla (ix+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x27, "sla (ix+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x28, "sra (ix+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x29, "sra (ix+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x2a, "sra (ix+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x2b, "sra (ix+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x2c, "sra (ix+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x2d, "sra (ix+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x2e, "sra (ix+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x2f, "sra (ix+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x30, "sll (ix+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x31, "sll (ix+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x32, "sll (ix+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x33, "sll (ix+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x34, "sll (ix+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x35, "sll (ix+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x36, "sll (ix+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x37, "sll (ix+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x38, "srl (ix+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x39, "srl (ix+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x3a, "srl (ix+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x3b, "srl (ix+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x3c, "srl (ix+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x3d, "srl (ix+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x3e, "srl (ix+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x3f, "srl (ix+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x40, "bit 0,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x41, "bit 0,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x42, "bit 0,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x43, "bit 0,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x44, "bit 0,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x45, "bit 0,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x46, "bit 0,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x47, "bit 0,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x48, "bit 1,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x49, "bit 1,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x4a, "bit 1,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x4b, "bit 1,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x4c, "bit 1,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x4d, "bit 1,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x4e, "bit 1,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x4f, "bit 1,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x50, "bit 2,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x51, "bit 2,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x52, "bit 2,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x53, "bit 2,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x54, "bit 2,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x55, "bit 2,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x56, "bit 2,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x57, "bit 2,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x58, "bit 3,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x59, "bit 3,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x5a, "bit 3,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x5b, "bit 3,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x5c, "bit 3,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x5d, "bit 3,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x5e, "bit 3,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x5f, "bit 3,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x60, "bit 4,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x61, "bit 4,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x62, "bit 4,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x63, "bit 4,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x64, "bit 4,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x65, "bit 4,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x66, "bit 4,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x67, "bit 4,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x68, "bit 5,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x69, "bit 5,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x6a, "bit 5,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x6b, "bit 5,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x6c, "bit 5,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x6d, "bit 5,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x6e, "bit 5,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x6f, "bit 5,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x70, "bit 6,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x71, "bit 6,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x72, "bit 6,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x73, "bit 6,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x74, "bit 6,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x75, "bit 6,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x76, "bit 6,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x77, "bit 6,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x78, "bit 7,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x79, "bit 7,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x7a, "bit 7,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x7b, "bit 7,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x7c, "bit 7,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x7d, "bit 7,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x7e, "bit 7,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x7f, "bit 7,(ix+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::DDCB      , 0x80, "res 0,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x81, "res 0,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x82, "res 0,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x83, "res 0,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x84, "res 0,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x85, "res 0,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x86, "res 0,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x87, "res 0,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x88, "res 1,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x89, "res 1,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x8a, "res 1,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x8b, "res 1,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x8c, "res 1,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x8d, "res 1,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x8e, "res 1,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x8f, "res 1,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x90, "res 2,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x91, "res 2,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x92, "res 2,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x93, "res 2,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x94, "res 2,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x95, "res 2,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x96, "res 2,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x97, "res 2,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x98, "res 3,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x99, "res 3,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x9a, "res 3,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x9b, "res 3,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x9c, "res 3,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x9d, "res 3,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x9e, "res 3,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0x9f, "res 3,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa0, "res 4,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa1, "res 4,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa2, "res 4,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa3, "res 4,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa4, "res 4,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa5, "res 4,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa6, "res 4,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa7, "res 4,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa8, "res 5,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xa9, "res 5,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xaa, "res 5,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xab, "res 5,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xac, "res 5,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xad, "res 5,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xae, "res 5,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xaf, "res 5,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb0, "res 6,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb1, "res 6,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb2, "res 6,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb3, "res 6,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb4, "res 6,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb5, "res 6,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb6, "res 6,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb7, "res 6,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb8, "res 7,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xb9, "res 7,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xba, "res 7,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xbb, "res 7,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xbc, "res 7,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xbd, "res 7,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xbe, "res 7,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xbf, "res 7,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc0, "set 0,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc1, "set 0,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc2, "set 0,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc3, "set 0,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc4, "set 0,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc5, "set 0,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc6, "set 0,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc7, "set 0,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc8, "set 1,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xc9, "set 1,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xca, "set 1,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xcb, "set 1,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xcc, "set 1,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xcd, "set 1,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xce, "set 1,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xcf, "set 1,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd0, "set 2,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd1, "set 2,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd2, "set 2,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd3, "set 2,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd4, "set 2,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd5, "set 2,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd6, "set 2,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd7, "set 2,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd8, "set 3,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xd9, "set 3,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xda, "set 3,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xdb, "set 3,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xdc, "set 3,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xdd, "set 3,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xde, "set 3,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xdf, "set 3,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe0, "set 4,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe1, "set 4,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe2, "set 4,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe3, "set 4,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe4, "set 4,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe5, "set 4,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe6, "set 4,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe7, "set 4,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe8, "set 5,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xe9, "set 5,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xea, "set 5,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xeb, "set 5,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xec, "set 5,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xed, "set 5,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xee, "set 5,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xef, "set 5,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf0, "set 6,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf1, "set 6,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf2, "set 6,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf3, "set 6,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf4, "set 6,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf5, "set 6,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf6, "set 6,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf7, "set 6,(ix+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf8, "set 7,(ix+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xf9, "set 7,(ix+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xfa, "set 7,(ix+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xfb, "set 7,(ix+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xfc, "set 7,(ix+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xfd, "set 7,(ix+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xfe, "set 7,(ix+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::DDCB      , 0xff, "set 7,(ix+*),a"            , 4, 1, 20,  0, false},

// ── FDCB prefix (256 entries) ──
{OpcodePrefix::FDCB      , 0x00, "rlc (iy+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x01, "rlc (iy+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x02, "rlc (iy+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x03, "rlc (iy+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x04, "rlc (iy+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x05, "rlc (iy+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x06, "rlc (iy+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x07, "rlc (iy+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x08, "rrc (iy+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x09, "rrc (iy+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x0a, "rrc (iy+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x0b, "rrc (iy+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x0c, "rrc (iy+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x0d, "rrc (iy+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x0e, "rrc (iy+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x0f, "rrc (iy+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x10, "rl (iy+*),b"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x11, "rl (iy+*),c"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x12, "rl (iy+*),d"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x13, "rl (iy+*),e"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x14, "rl (iy+*),h"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x15, "rl (iy+*),l"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x16, "rl (iy+*)"                 , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x17, "rl (iy+*),a"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x18, "rr (iy+*),b"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x19, "rr (iy+*),c"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x1a, "rr (iy+*),d"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x1b, "rr (iy+*),e"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x1c, "rr (iy+*),h"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x1d, "rr (iy+*),l"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x1e, "rr (iy+*)"                 , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x1f, "rr (iy+*),a"               , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x20, "sla (iy+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x21, "sla (iy+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x22, "sla (iy+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x23, "sla (iy+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x24, "sla (iy+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x25, "sla (iy+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x26, "sla (iy+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x27, "sla (iy+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x28, "sra (iy+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x29, "sra (iy+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x2a, "sra (iy+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x2b, "sra (iy+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x2c, "sra (iy+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x2d, "sra (iy+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x2e, "sra (iy+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x2f, "sra (iy+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x30, "sll (iy+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x31, "sll (iy+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x32, "sll (iy+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x33, "sll (iy+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x34, "sll (iy+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x35, "sll (iy+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x36, "sll (iy+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x37, "sll (iy+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x38, "srl (iy+*),b"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x39, "srl (iy+*),c"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x3a, "srl (iy+*),d"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x3b, "srl (iy+*),e"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x3c, "srl (iy+*),h"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x3d, "srl (iy+*),l"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x3e, "srl (iy+*)"                , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x3f, "srl (iy+*),a"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x40, "bit 0,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x41, "bit 0,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x42, "bit 0,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x43, "bit 0,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x44, "bit 0,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x45, "bit 0,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x46, "bit 0,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x47, "bit 0,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x48, "bit 1,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x49, "bit 1,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x4a, "bit 1,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x4b, "bit 1,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x4c, "bit 1,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x4d, "bit 1,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x4e, "bit 1,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x4f, "bit 1,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x50, "bit 2,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x51, "bit 2,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x52, "bit 2,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x53, "bit 2,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x54, "bit 2,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x55, "bit 2,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x56, "bit 2,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x57, "bit 2,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x58, "bit 3,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x59, "bit 3,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x5a, "bit 3,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x5b, "bit 3,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x5c, "bit 3,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x5d, "bit 3,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x5e, "bit 3,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x5f, "bit 3,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x60, "bit 4,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x61, "bit 4,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x62, "bit 4,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x63, "bit 4,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x64, "bit 4,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x65, "bit 4,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x66, "bit 4,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x67, "bit 4,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x68, "bit 5,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x69, "bit 5,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x6a, "bit 5,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x6b, "bit 5,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x6c, "bit 5,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x6d, "bit 5,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x6e, "bit 5,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x6f, "bit 5,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x70, "bit 6,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x71, "bit 6,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x72, "bit 6,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x73, "bit 6,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x74, "bit 6,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x75, "bit 6,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x76, "bit 6,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x77, "bit 6,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x78, "bit 7,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x79, "bit 7,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x7a, "bit 7,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x7b, "bit 7,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x7c, "bit 7,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x7d, "bit 7,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x7e, "bit 7,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x7f, "bit 7,(iy+*)"              , 4, 1, 16,  0, false},
{OpcodePrefix::FDCB      , 0x80, "res 0,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x81, "res 0,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x82, "res 0,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x83, "res 0,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x84, "res 0,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x85, "res 0,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x86, "res 0,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x87, "res 0,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x88, "res 1,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x89, "res 1,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x8a, "res 1,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x8b, "res 1,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x8c, "res 1,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x8d, "res 1,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x8e, "res 1,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x8f, "res 1,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x90, "res 2,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x91, "res 2,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x92, "res 2,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x93, "res 2,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x94, "res 2,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x95, "res 2,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x96, "res 2,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x97, "res 2,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x98, "res 3,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x99, "res 3,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x9a, "res 3,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x9b, "res 3,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x9c, "res 3,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x9d, "res 3,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x9e, "res 3,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0x9f, "res 3,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa0, "res 4,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa1, "res 4,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa2, "res 4,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa3, "res 4,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa4, "res 4,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa5, "res 4,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa6, "res 4,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa7, "res 4,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa8, "res 5,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xa9, "res 5,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xaa, "res 5,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xab, "res 5,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xac, "res 5,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xad, "res 5,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xae, "res 5,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xaf, "res 5,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb0, "res 6,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb1, "res 6,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb2, "res 6,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb3, "res 6,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb4, "res 6,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb5, "res 6,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb6, "res 6,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb7, "res 6,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb8, "res 7,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xb9, "res 7,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xba, "res 7,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xbb, "res 7,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xbc, "res 7,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xbd, "res 7,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xbe, "res 7,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xbf, "res 7,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc0, "set 0,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc1, "set 0,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc2, "set 0,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc3, "set 0,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc4, "set 0,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc5, "set 0,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc6, "set 0,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc7, "set 0,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc8, "set 1,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xc9, "set 1,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xca, "set 1,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xcb, "set 1,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xcc, "set 1,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xcd, "set 1,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xce, "set 1,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xcf, "set 1,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd0, "set 2,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd1, "set 2,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd2, "set 2,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd3, "set 2,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd4, "set 2,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd5, "set 2,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd6, "set 2,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd7, "set 2,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd8, "set 3,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xd9, "set 3,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xda, "set 3,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xdb, "set 3,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xdc, "set 3,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xdd, "set 3,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xde, "set 3,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xdf, "set 3,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe0, "set 4,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe1, "set 4,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe2, "set 4,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe3, "set 4,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe4, "set 4,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe5, "set 4,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe6, "set 4,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe7, "set 4,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe8, "set 5,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xe9, "set 5,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xea, "set 5,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xeb, "set 5,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xec, "set 5,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xed, "set 5,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xee, "set 5,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xef, "set 5,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf0, "set 6,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf1, "set 6,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf2, "set 6,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf3, "set 6,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf4, "set 6,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf5, "set 6,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf6, "set 6,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf7, "set 6,(iy+*),a"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf8, "set 7,(iy+*),b"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xf9, "set 7,(iy+*),c"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xfa, "set 7,(iy+*),d"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xfb, "set 7,(iy+*),e"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xfc, "set 7,(iy+*),h"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xfd, "set 7,(iy+*),l"            , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xfe, "set 7,(iy+*)"              , 4, 1, 20,  0, false},
{OpcodePrefix::FDCB      , 0xff, "set 7,(iy+*),a"            , 4, 1, 20,  0, false},

// ── Entry counts ──
//   NONE  :  252
//   CB    :  256
//   ED    :   78
//   DD    :   85
//   FD    :   85
//   DDCB  :  256
//   FDCB  :  256
//   TOTAL : 1268
};

const int g_z80_opcode_count = sizeof(g_z80_opcodes) / sizeof(g_z80_opcodes[0]);

// ── Lookup tables (built by z80_opcode_table_init) ──

// Key = (prefix << 8) | opcode
static std::unordered_map<int, const Z80Opcode*> s_disasm_lookup;

// Key = uppercase mnemonic pattern, value = matching entries
static std::unordered_map<std::string, std::vector<const Z80Opcode*>> s_asm_lookup;

// Set of known mnemonic keywords (first word of each pattern, uppercased)
static std::unordered_map<std::string, bool> s_mnemonic_keywords;

static bool s_initialized = false;
static std::vector<const Z80Opcode*> s_empty_vec;

static int prefix_to_key(OpcodePrefix p) {
    switch (p) {
        case OpcodePrefix::NONE: return 0;
        case OpcodePrefix::CB:   return 1;
        case OpcodePrefix::ED:   return 2;
        case OpcodePrefix::DD:   return 3;
        case OpcodePrefix::FD:   return 4;
        case OpcodePrefix::DDCB: return 5;
        case OpcodePrefix::FDCB: return 6;
    }
    return 0;
}

void z80_opcode_table_init() {
    if (s_initialized) return;
    s_disasm_lookup.clear();
    s_asm_lookup.clear();
    s_mnemonic_keywords.clear();

    for (int i = 0; i < g_z80_opcode_count; i++) {
        const auto& op = g_z80_opcodes[i];

        // Disassembler lookup: prefix_key | opcode
        int key = (prefix_to_key(op.prefix) << 8) | op.opcode;
        s_disasm_lookup[key] = &op;

        // Assembler lookup: uppercase mnemonic pattern
        std::string upper;
        for (const char* p = op.mnemonic; *p; p++)
            upper += static_cast<char>(toupper(static_cast<unsigned char>(*p)));
        s_asm_lookup[upper].push_back(&op);

        // Extract the first word as a mnemonic keyword
        std::string keyword;
        for (const char* p = op.mnemonic; *p && *p != ' '; p++)
            keyword += static_cast<char>(toupper(static_cast<unsigned char>(*p)));
        s_mnemonic_keywords[keyword] = true;
    }

    s_initialized = true;
}

bool z80_is_mnemonic_keyword(const std::string& word) {
    return s_mnemonic_keywords.count(word) > 0;
}

const Z80Opcode* z80_opcode_lookup(OpcodePrefix prefix, byte opcode) {
    int key = (prefix_to_key(prefix) << 8) | opcode;
    auto it = s_disasm_lookup.find(key);
    return it != s_disasm_lookup.end() ? it->second : nullptr;
}

const std::vector<const Z80Opcode*>& z80_asm_lookup(const std::string& pattern) {
    auto it = s_asm_lookup.find(pattern);
    return it != s_asm_lookup.end() ? it->second : s_empty_vec;
}

int z80_opcode_to_legacy_key(const Z80Opcode& op) {
    switch (op.prefix) {
        case OpcodePrefix::NONE: return op.opcode;
        case OpcodePrefix::CB:   return 0xCB00 | op.opcode;
        case OpcodePrefix::ED:   return 0xED00 | op.opcode;
        case OpcodePrefix::DD:   return 0xDD00 | op.opcode;
        case OpcodePrefix::FD:   return 0xFD00 | op.opcode;
        case OpcodePrefix::DDCB: return 0xDDCB00 | op.opcode;
        case OpcodePrefix::FDCB: return 0xFDCB00 | op.opcode;
    }
    return op.opcode;
}

std::string z80_opcode_table_to_txt() {
    // Output order matches original z80_opcodes.txt: NONE, ED, CB, DD, DDCB, FD, FDCB
    static const OpcodePrefix output_order[] = {
        OpcodePrefix::NONE, OpcodePrefix::ED, OpcodePrefix::CB,
        OpcodePrefix::DD, OpcodePrefix::DDCB,
        OpcodePrefix::FD, OpcodePrefix::FDCB
    };

    std::ostringstream oss;
    for (auto prefix : output_order) {
        for (int i = 0; i < g_z80_opcode_count; i++) {
            const auto& op = g_z80_opcodes[i];
            if (op.prefix != prefix) continue;
            int key = z80_opcode_to_legacy_key(op);
            oss << "0x" << std::hex << std::setfill('0');
            switch (op.prefix) {
                case OpcodePrefix::NONE:
                    oss << std::setw(2) << key;
                    break;
                case OpcodePrefix::CB:
                case OpcodePrefix::ED:
                case OpcodePrefix::DD:
                case OpcodePrefix::FD:
                    oss << std::setw(4) << key;
                    break;
                case OpcodePrefix::DDCB:
                case OpcodePrefix::FDCB:
                    oss << std::setw(6) << key;
                    break;
            }
            oss << ":" << op.mnemonic << "\n";
        }
    }
    return oss.str();
}
